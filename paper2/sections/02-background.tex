\section{Background and Motivation}
\label{sec:background}

\subsection{Traditional Authorization Architecture}

Modern web services implement authorization through a complex infrastructure stack. A typical OAuth 2.0~\cite{oauth2} deployment follows a multi-step flow: (1) the client initiates authentication and requests authorization scopes, (2) the user authenticates with the authorization server and grants consent, (3) the authorization server issues an authorization code, (4) the client exchanges the code for an access token, and (5) the client presents the access token to the resource server on each API request. This flow requires an authorization server (e.g., Auth0, Okta, AWS Cognito) that manages authentication state, issues tokens, and maintains session databases. Access tokens must be validated on each API request through either database lookups for opaque tokens or cryptographic verification for JWTs. For subscription-based services, this infrastructure expands further to include payment processors (Stripe, Chargebee), subscription management databases, and webhook handlers to synchronize payment events with authorization state.

This architecture introduces several operational challenges. First, authorization state is fragmented across multiple systems: OAuth servers maintain authentication state, databases track subscription status, and payment processors record billing history. Revoking access requires coordinating updates across these systems, often taking minutes to hours to propagate. Second, each component represents a potential single point of failure, requiring redundancy and monitoring infrastructure. Third, audit trails are distributed across system logs, database records, and external service APIs, making compliance and debugging difficult.

The infrastructure costs are substantial. An OAuth server deployment with high availability costs \$500--\$2,000 per month for hosted services~\cite{auth0pricing,oktapricing}---with Auth0's free tier supporting 25,000 Monthly Active Users (MAUs) but paid plans starting at \$35/month for B2C and \$240/month for Professional tier (1,000 MAUs). AWS Cognito's November 2024 restructuring reduced the free tier from 50,000 to 10,000 MAUs, with Essentials tier costing \$0.015/MAU (\$1,350/month for 100,000 users). Okta requires a minimum \$3,000/month base for Customer Identity with annual contracts exceeding \$1,500. Database costs for session storage scale with user activity, and payment processor integration adds 2.9\% + \$0.30 per transaction. The operational complexity creates vendor lock-in, as migrating between authorization providers requires rebuilding authentication flows and migrating user credentials.

\subsection{The AI Agent Authorization Challenge}

The rise of AI agents has exposed fundamental limitations in OAuth-based authorization. Large language models like Claude, GPT-4, and autonomous Model Context Protocol (MCP) servers require programmatic API access without human intervention. OAuth 2.0's interactive flows (authorization code flow with PKCE, device flow) assume a human user can complete browser-based authentication, which is impossible for fully autonomous agents.

Current solutions are inadequate. Long-lived API keys provide programmatic access but lack automatic expiration, fine-grained permissions, and instant revocation capabilities. They are also not easily tradeable or transferable, preventing market-based allocation of API access. OAuth 2.0 client credentials flow supports machine-to-machine authentication but still requires centralized credential storage and management. As AI agents increasingly mediate user interactions with web services, the need for decentralized, programmatic, and transferable authorization credentials becomes critical.

\subsection{Blockchain as an Authorization Layer}

Blockchain technology offers an alternative paradigm: representing authorization as verifiable on-chain state rather than centralized credential management. Token ownership on a public blockchain provides several properties valuable for authorization:

\begin{itemize}
\item \textbf{Persistent State}: Token balances are maintained by the blockchain consensus mechanism, eliminating the need for authorization servers and session databases.

\item \textbf{Cryptographic Verification}: Ownership is proven by digital signatures, enabling stateless verification without database lookups.

\item \textbf{Immutable Audit Trail}: Every token transfer, purchase, and state change is recorded on the blockchain, providing complete accountability.

\item \textbf{Atomic Transactions}: Smart contracts enable atomic payment-authorization operations, eliminating the coordination complexity between payment processors and authorization systems.

\item \textbf{Decentralized Verification}: Any party can verify token ownership via blockchain RPC calls, removing dependency on centralized authorization servers.
\end{itemize}

However, existing token standards were designed for asset ownership rather than authorization. ERC-20 fungible tokens lack multi-token type support and non-transferability. ERC-721 NFTs enforce single ownership (non-fungible), preventing subscription-style authorization where multiple users access the same service tier. ERC-1155 and ERC-6909 support multiple token types and batch operations but lack features essential for authorization: time-bounded validity (TTL), soulbound (non-transferable) tokens, instant revocation mechanisms, and integrated purchase flows.

\subsection{Token Standards Background}

We briefly review the evolution of Ethereum token standards to motivate EVMAuth's design:

\textbf{ERC-20}~\cite{erc20} (2015) established the fungible token interface with \texttt{transfer}, \texttt{approve}, and \texttt{allowance} functions. Its simplicity enabled widespread adoption but limits it to single-token contracts, requiring separate deployments for different access tiers. ERC-20 transfers consume approximately 50,000--65,000 gas, while the approval mechanism introduces the well-documented approve race condition vulnerability (SWC-114).

\textbf{ERC-721}~\cite{erc721} (2018) introduced non-fungible tokens (NFTs) with unique token IDs. While supporting multiple token types within one contract, each token is unique and non-divisible, making it unsuitable for subscription models where many users hold identical access rights. The standard includes safe transfer mechanisms requiring recipient contracts to implement the \texttt{IERC721Receiver} interface.

\textbf{ERC-1155}~\cite{erc1155} (2018) unified fungible and non-fungible tokens in a single contract, enabling batch operations and flexible metadata. Batch operations provide approximately 30\% gas savings---\texttt{safeBatchTransferFrom} for three tokens consuming 132,437 gas versus 189,861 gas for three separate transfers. However, it requires safe transfer callbacks (increasing gas costs) and lacks authorization-specific features like automatic expiration.

\textbf{ERC-6909}~\cite{erc6909} (2023) provides a minimal multi-token standard optimized for gas efficiency, removing callbacks and simplifying approvals. The critical addition is granular allowances through a three-dimensional \texttt{allowance} mapping enabling token-specific, amount-specific permissions---a capability ERC-1155 lacks entirely. Uniswap v4 adopted ERC-6909 for internal accounting, noting improved gas efficiency for deployment, transfers, and burning operations. However, it similarly lacks TTL and revocation primitives.

None of these standards address the specific requirements of authorization: time-bounded validity for subscriptions, non-transferability for personal licenses, instant revocation for security, or atomic purchase flows that combine payment and token issuance. EVMAuth extends these standards with authorization primitives while maintaining compatibility with existing token infrastructure.

\subsection{Emerging Use Cases}

Several emerging trends motivate blockchain-based authorization systems that extend beyond traditional human-interactive authentication models.

\textbf{AI Agent Programmatic Access.} Large language models including Claude (Anthropic), GPT-4 (OpenAI), and autonomous agents built on frameworks like LangChain, AutoGPT, and CrewAI increasingly require API access to external services. These agents operate without human intervention, making OAuth 2.0's interactive consent flows impractical. Current approaches rely on static API keys stored in environment variables---credentials that lack automatic expiration, fine-grained scoping, or instant revocation capabilities. Model Context Protocol (MCP) servers, which provide tools and data sources to AI models, similarly require programmatic authentication that does not assume browser-based user interaction. Token-based authorization enables agents to autonomously purchase, hold, and present access credentials without human-in-the-loop authentication.

\textbf{Decentralized API Marketplaces.} Traditional API access is tied to centralized provider accounts with non-transferable credentials. Blockchain-based authorization enables secondary markets for API access: users can purchase short-term access tokens, resell unused capacity, or transfer subscriptions between wallets. This creates price discovery mechanisms where API access becomes a tradeable commodity. Services can implement dynamic pricing through bonding curves in smart contracts, automatically adjusting access token costs based on demand. The atomic nature of blockchain transactions ensures that payment and authorization occur simultaneously, eliminating the coordination overhead between payment processors and authorization systems.

\textbf{Cross-Platform Subscription Portability.} Users currently manage separate subscriptions across platforms, each with its own billing cycle, payment method, and cancellation process. Token-based authorization enables a single on-chain subscription to grant access across multiple services. For example, a premium tier token could provide access to API rate limits on Service A, premium features on Service B, and exclusive content on Service C---all verified through the same on-chain balance check. Token enumeration allows users to discover all their active subscriptions in one place by querying blockchain state, rather than navigating multiple account dashboards.

\textbf{Autonomous System-to-System Authorization.} As web3 infrastructure matures, smart contracts increasingly need to access external APIs: oracles fetching off-chain data, automated trading systems calling exchange APIs, or DAO treasury managers integrating with payment services. Traditional authorization requires human setup of API keys for each integration. Token-based authorization allows smart contracts to directly hold authorization tokens, enabling fully autonomous service consumption where contracts purchase access, verify permissions, and renew subscriptions without human intervention.

These use cases share common requirements that existing authorization systems do not address: programmatic, non-interactive authentication; transferable or tradeable credentials; verifiable on-chain state; and compatibility with autonomous agents. EVMAuth's design specifically targets these emerging patterns while maintaining security properties essential for access control.

\subsection{Related Work and Existing Solutions}

Several systems have explored blockchain-based access control, each with distinct architectural trade-offs that inform EVMAuth's design choices.

\textbf{Off-Chain Verification Services.} Collab.Land~\cite{collabland} and Guild.xyz represent the current standard for token-gated access control, serving over 47,000 communities collectively. Both systems read blockchain state to verify token ownership but enforce access through centralized infrastructure. Collab.Land uses Alchemy's NFT API for verification with update latencies of 24 hours to 7 days depending on subscription tier, deploying no smart contracts for access control. Guild.xyz supports 60+ EVM chains with sophisticated requirement composition (AND/OR/NOR operators) but verification occurs on centralized backends. While these platforms offer zero gas costs for users, they introduce vendor dependency, privacy concerns (wallet-to-social identity mappings), and incompatibility with autonomous programmatic access.

\textbf{On-Chain Membership Protocols.} Unlock Protocol~\cite{unlock} provides fully on-chain membership through ERC-721 Keys with native time-based expiration. The protocol uses a factory pattern (\texttt{Unlock.sol} deploying \texttt{PublicLock.sol} instances) with functions like \texttt{keyExpirationTimestampFor} and \texttt{getHasValidKey} for temporal access control. Gas costs range from 100--200K for Key purchases. Unlock's hook system (\texttt{onKeyPurchaseHook}, \texttt{onValidKeyHook}) enables extensibility, and the protocol charges a 1\% fee on transactions. However, Unlock targets human-centric subscription models with wallet-holding users navigating purchase flows, making it unsuitable for programmatic API authorization where agents require autonomous, non-interactive access. Additionally, very short-lived access tokens (minutes to hours) become impractical given transaction overhead.

\textbf{Decentralized Identity Systems.} ENS~\cite{ens} and Lens Protocol~\cite{lens} address adjacent problems in the authentication stack. ENS provides human-readable identifiers through a Registry-Resolver architecture, with the Name Wrapper enabling permission restrictions via fuses (\texttt{CANNOT\_TRANSFER}, \texttt{PARENT\_CANNOT\_CONTROL}). Text records (ENSIP-5/18) can link hot wallets to cold storage via \texttt{eip5131:<authKey>}, but these remain name-level permissions rather than general authorization primitives. Lens Protocol builds on-chain social graphs with Profile NFTs and Rules for content gating, but authorization capabilities remain social-context-specific (following relationships, collection ownership) rather than supporting arbitrary API permissions.

\textbf{Theoretical Foundations.} The concept of soulbound tokens (SBTs)~\cite{soulbound} introduced non-transferable credentials for representing commitments and affiliations. Weyl et al. propose using SBTs for community wallet recovery, Sybil-resistant governance, and uncollateralized lending based on social reputation. While SBTs address non-transferability, they do not provide time-bounded validity, revocation mechanisms, or integrated purchase flows. EIP-5192~\cite{eip5192} formalizes minimal soulbound NFTs but remains a non-standard extension requiring custom implementation.

\textbf{AI Agent Authentication.} Emerging standards recognize the gap in autonomous agent authorization. ERC-8004 (Trustless Agents)~\cite{erc8004} establishes three on-chain registries: an ERC-721 Identity Registry, Reputation Registry, and Validation Registry supporting staking and TEE attestations. However, it remains in draft status with limited deployment. Session keys (ERC-7710~\cite{erc7710}, ERC-7579) provide delegation primitives with scoped permissions, time limits, and spending caps, but require initial setup transactions and focus on delegating existing wallet capabilities rather than defining new authorization models. The x402 protocol addresses agent-to-agent payments but not capability authorization.

\textbf{Smart Contract Security Research.} MadMax~\cite{madmax} pioneered static analysis for gas-related vulnerabilities, identifying unbounded mass operations that cause out-of-gas conditions. Zhou et al.~\cite{defi-survey} taxonomized DeFi attacks covering \$3.24B+ in losses, analyzing reentrancy, oracle manipulation, and flash loan exploits. Chen et al.~\cite{chen2020survey} systematically enumerated 40 vulnerability types across smart contract, EVM, consensus, and network layers. These works inform EVMAuth's security design, particularly regarding bounded storage to prevent denial-of-service attacks and reentrancy protection in token transfer callbacks.

EVMAuth distinguishes itself through: (1) \textbf{trustless on-chain verification} eliminating centralized infrastructure dependency, (2) \textbf{composable authorization primitives} (ephemeral tokens, soulbound mechanics, instant revocation) as native features rather than extensions, (3) \textbf{bounded-storage ephemeral access} optimized for session-based API authorization, and (4) \textbf{explicit design for autonomous AI agents} requiring programmatic access without human-interactive flows. The gas cost trade-off (6,975--148,182 gas for operations) represents the price of decentralization, comparable to Unlock's on-chain operations but substantially higher than zero-cost off-chain verification services.
